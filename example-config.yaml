serviceHooks:
- event: git.pullrequest.updated
  resourceFilters:
    statuses:
    - completed
    - abandoned
    reasons: []
    projects: []
    repositories: []
    sourceRefs:
    - refs/heads/feature/*
    targetRefs:
    - refs/heads/master
    templates:
    - '{{ contains (.CreatedBy.DisplayName | title) "Obama" }}'
  rules:
    delete:
    - apiVersion: v1
      kind: Namespace
      selector:
        matchLabels:
          azdPullRequestId: '{{ .PullRequestId }}'
        matchExpressions:
        - key: azdPreserve
          operator: DoesNotExist
          values: []
- event: build.complete
  resourceFilters:
    statuses: []
    reasons:
    - manual
    projects: []
    templates:
    - '{{ eq .Definition.DefinitionType "yaml" }}'
  rules:
    delete:
    - apiVersion: v1
      kind: Namespace
      selector:
        matchLabels:
          azdBuildId: '{{ .BuildId }}'
        matchExpressions:
        - key: azdPreserve
          operator: DoesNotExist
          values: []
        - key: azdPullRequestId
          operator: DoesNotExist
          values: []